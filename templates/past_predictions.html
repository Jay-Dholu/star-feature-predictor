{% extends "base.html" %}

{% block past_predictions %}
	<div class="block mx-auto bg-cyan-800 text-center text-white text-2xl mt-10 px-4 py-2 w-1/3 rounded-2xl shadowed-xl">
		{% if target == "star_color" %}
			Star Color is:  {{ model_prediction }}
		{% elif target == "spectral_class" %}
			Spectral Class is:  {{ model_prediction }}
		{% elif target == "star_type" %}
			Star Type is:  {{ model_prediction }}
		{% elif target == "temperature" %}
			Temperature is:  {{ model_prediction }} Kelvin
		{% elif target == "radius" %}
			Radius is:  {{ model_prediction }} R☉ (Solar Radii)
		{% elif target == "luminosity" %}
			Luminosity is:  {{ model_prediction }} L☉ (Solar Luminosities)
		{% elif target == "absolute_magnitude" %}
			Absolute Magnitude is:  {{ model_prediction }}
		{% else %}
			Nothing to predict yet
		{% endif %}
	</div>
	<div>
		<div class="container mx-auto mt-10 pb-10">
			<h1 class="text-3xl font-bold mb-6 text-center text-white">Prediction History</h1>
			{% if predictions %}
				<table class="table-auto w-full text-white border border-gray-500">
					<thead class="bg-gray-800">
						<tr>
							<th class="px-4 py-2 border">Date And Time</th>
							<th class="px-4 py-2 border">Details</th>
							<th class="px-4 py-2 border">Feature To Predict</th>
							<th class="px-4 py-2 border">Prediction</th>
							<th class="px-4 py-2 border">Delete Prediction</th>
						</tr>
					</thead>
					<tbody>
						{% for prediction in predictions %}
							<tr class="bg-gray-700">
								<td class="border px-4 py-2 text-center">{{ prediction.prediction_time.strftime('%Y-%m-%d %H:%M:%S') }} IST</td>
								<td class="border px-4 py-2">
									<ul class="flex flex-col gap-2">
										{% for key, value in prediction.input_data.items() %}
											{% if key is not none and target is not none and key.replace("_", " ") == target.replace("_", " ").title() %}

											{% elif value != None %}
												<li class="flex justify-between">
													<strong class="text-left">{{ key.replace("_", " ") }}</strong>
													<span class="text-right">{{ value }}</span>
												</li>
											{% endif %}
										{% endfor %}
									</ul>
								</td>
								<td class="border px-4 py-2 text-center">{{ prediction.predicted_feature }}</td>
								<td class="border px-4 py-2 text-center">{{ "{}".format(prediction.prediction) }}</td>
								<td class="border px-4 py-2 text-center">
									<form action="{{ url_for('delete_prediction', prediction_id=prediction.id) }}" method="POST">
										<button type="submit" class="bg-red-500 hover:bg-red-600 text-white font-bold py-1 px-3 rounded">
											Delete
										</button>
									</form>
								</td>
							</tr>
						{% endfor %}
					</tbody>
				</table>
			{% else %}
				<p class="text-white text-center">No prediction history yet.</p>
			{% endif %}
		</div>
	</div>
{% endblock past_predictions %}
